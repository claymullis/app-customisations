#!/bin/bash
set -ex

if [ "$1" == "update" ]; then
	here="$0"
	zeroinstall-plugin-manager http://gfxmonk.net/dist/0install/gnome-shell.xml --plugin-opt -rcd --plugin-opt --command=''
	sed -i.bak -e '/^# AUTO/,$d' "$here"
	echo '# AUTO GENERATED - do not modify below this line' >> "$here"
	0launch \
		'http://gfxmonk.net/dist/0install/0path.xml' \
		"$HOME/.config/zeroinstall-plugin-manager/http%3A%2F%2Fgfxmonk.net%2Fdist%2F0install%2Fgnome-shell.xml/user-feed.xml" | \
		fgrep -v '_0path_' \
		>> "$here"
	echo "exec /usr/bin/gnome-shell" >> "$here"
	exit
fi

# AUTO GENERATED - do not modify below this line
export GJS_PATH=$'/home/tim/dev/gnome-shell/shellshape@gfxmonk.net/lib:/home/tim/dev/gnome-shell/shellshape@gfxmonk.net/lib'
export XDG_DATA_DIRS=$'/home/tim/.cache/0install.net/implementations/sha256=fa88a066eb0c196b3b7612288b66123ae14ab9508969baa5b961d2df85bf1236/xdg/data:/home/tim/.cache/0install.net/implementations/sha256=851f0c2a3a7a624451ecfa072da568ea052f4e7ceedce42b7a228ff2dbd7cf75/xdg/data:/home/tim/dev/gnome-shell/shellshape@gfxmonk.net/xdg/data:/home/tim/.cache/0install.net/implementations/sha256=fa88a066eb0c196b3b7612288b66123ae14ab9508969baa5b961d2df85bf1236/xdg/data:/home/tim/dev/gnome-shell/shellshape@gfxmonk.net/xdg/data:/home/tim/.cache/0install.net/implementations/sha256=851f0c2a3a7a624451ecfa072da568ea052f4e7ceedce42b7a228ff2dbd7cf75/xdg/data:/usr/local/share:/usr/share'
exec /usr/bin/gnome-shell
